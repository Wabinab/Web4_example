<div class="container pt-3 pb-5">

  <form id="writeform">
    <input type="submit" class="btn btn-success btn-lg col-4" value="Save to IPFS">

    <p class="pt-3">Get an API Key <a href="https://nft.storage/manage/">here</a></p>
    <p>
      <label for="api_key">NFT Storage API Key:</label>
      <textarea id="api_key" cols="80" rows="4"></textarea>
    </p>
    <p>
      <textarea id="editor" form="writeform"></textarea>
    </p>

    <input type="submit" class="btn btn-success btn-lg col-4" value="Save to IPFS">
  </form>
</div>

<script>
  const editMde = new SimpleMDE({
    element: document.getElementById('editor'),
    placeholder: "Write Your Thoughts!",
    autosave: {
      enabled: true,
      uniqueId: "InternalSaveWrite",
    }
  });

  const ApiKey = document.getElementById('api_key');
  var storage_key_name = 'nftstorage_api_key'
  ApiKey.value = localStorage.getItem(storage_key_name);

  window.addEventListener("load", function() {
    const form = document.getElementById("writeform");

    form.addEventListener("submit", function (event) {
      event.preventDefault();

      localStorage.setItem(storage_key_name, ApiKey.value);

      window.store_nft(
        editMde.value(), 
        ApiKey.value
      );
    })
  })
</script>